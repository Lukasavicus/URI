<!DOCTYPE html>
<html>
<head>
	<title> Visualizer </title>
	<script type="text/javascript" src="prism.js"></script>
	<link rel="stylesheet" type="text/css" href="prism.css">
</head>
<body>
	<div>
		<input type="number" name="pid" id="_pid">
		<button id="search_prob" onclick="update()"> Search </button>
	</div>

	<div align="center">

		<object id='myPdfObject' type='application/pdf' width="90%" height="500 px">
			<embed id='myPdfEmbed' type='application/pdf' width="90%" height="500 px"></embed>
		</object>

		<div width="70%" height="500 px">
			<pre>
				<code id="_code" class="language-clike"></code>
			</pre>
		</div>

	</div>

	<script type="text/javascript">

		document.onload = update();

		function update(){
			var pid = document.getElementById('_pid').value || 1001;
			//loadProblemPDFById(pid);
			loadProblemPDFById2();
			loadSolutionCodeById(pid);
		}

		function loadProblemPDFById(pid){
			//var pdfUrl = "./URI-Problems/" + pid + ".pdf";

			//var pdfUrl = "https://github.com/Lukasavicus/URI/blob/master/URI-Problems/1001.pdf";

			var pdfUrl = "https://raw.githubusercontent.com/Lukasavicus/URI/master/URI-Problems/1001.pdf";

			var pdfViewerObject = document.getElementById("myPdfObject");
			pdfViewerObject.setAttribute("data", pdfUrl);
			pdfViewerObject.outerHTML = pdfViewerObject.outerHTML.replace(/data="(.+?)"/, 'data="' + pdfUrl + '"');
			 
			var pdfViewerEmbed = document.getElementById("myPdfEmbed");
			pdfViewerEmbed.setAttribute("src", pdfUrl);
			pdfViewerEmbed.outerHTML = pdfViewerEmbed.outerHTML.replace(/src="(.+?)"/, 'src="' + pdfUrl + '"');
		}

		function loadProblemPDFById2(){
			var pdfUrl = "https://github.com/Lukasavicus/URI/blob/master/URI-Problems/1001.pdf";
			//var pdfUrl = "https://raw.githubusercontent.com/Lukasavicus/URI/master/URI-Problems/1001.pdf";
			loadXMLFile(pdfUrl);
		}

		function loadSolutionCodeById(pid){
			var code = "https://raw.githubusercontent.com/Lukasavicus/URI/master/ACCEPTED/" + pid;
			loadXMLDoc(code);
		}

		function loadXMLDoc(theURL, extension_idx = 0){
			var extensions = ['.c', '.cpp'];
			url_and_extension = theURL + extensions[extension_idx];
	       if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari, SeaMonkey
	           xmlhttp=new XMLHttpRequest();
	       }
	       else{// code for IE6, IE5
	           xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	       }

	       xmlhttp.onreadystatechange=function(){
	           if (xmlhttp.readyState==4){
	           		if(xmlhttp.status==200){
		            	//alert(xmlhttp.responseText);
		            	var code_as_text = String(xmlhttp.responseText);

		            	var code_formatted = code_as_text.replace(/>/g,"&gt");
		            	code_formatted = code_formatted.replace(/</g, "&lt");

		            	document.getElementById("_code").innerHTML = code_formatted;
		            }
		            else if(xmlhttp.status==400 || xmlhttp.status==404){
		            	loadXMLDoc(theURL, extension_idx+1);
		            }
	           }
	       }

	       xmlhttp.open("GET", url_and_extension, false);
	       xmlhttp.send();
	   }

	   	function loadXMLFile(theURL){
			if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari, SeaMonkey
				xmlhttp=new XMLHttpRequest();
			}
			else{// code for IE6, IE5
				xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
			}

	          xmlhttp.onreadystatechange=function(){
	              if (xmlhttp.readyState==4 && xmlhttp.status==200){
	   	            	alert(xmlhttp.responseText);
	   	            }
	          }

	          xmlhttp.open("GET", theURL, false);
	          xmlhttp.send();
	    }

	</script>

</body>
</html>