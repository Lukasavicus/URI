
	<!DOCTYPE html>
	<html>
		<head>
			<title>URI 2214 - Shortest Flight Path</title>
			<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
			<meta name="author" content="URI Online Judge; www.urionlinejudge.edu.br" />
			<meta name="description" content="URI Online Judge - Problema 2214 - Shortest Flight Path" />

			<link href="https://fonts.googleapis.com/css?family=Ubuntu:400,700" rel="stylesheet" type="text/css">
			<link rel="stylesheet" type="text/css" href="https://urionlinejudge.r.worldssl.net/repository/contest.css" />

	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-28047757-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-28047757-1');
	</script>
		</head>
		<body>

			<div class="header">
				<span>URI Online Judge | 2214</span>
				<h1>Shortest Flight Path</h1>
				<div>
					<p>Por ICPC 2012 World Finals <img src='https://urionlinejudge.r.worldssl.net/gallery/images/flags/pl.gif' alt='PL' /> Poland</p>
				</div>
				<strong>Timelimit: 30</strong>
			</div>

			<div class="problem">

				<div class="description">
					<p>Commercial flights are statistically quite safe (in terms of number of deaths per passenger-kilometer, only going to the moon is safer). But there are still reasons for precautions and safety regulations. An early such rule was the so-called “60-minute rule,” which required that a two-engine plane must always be within 60 minutes of the nearest adequate airport along its entire flight path. A variety of similar rules have existed, but at their core, they remain the same: the flight path can not take the airplane more than a certain maximum allowed distance from the nearest airport. With these restrictions, planes cannot always use a direct route for flying from one airport to another.</p>

					<p>In this problem we will compute the shortest flight path between two airports while adhering to a maximum allowed distance rule. In the figure below, which illustrates the first sample test case, any flight route has to stay within the three circles. Thus a plane going from airport 2 to airport 3 has to detour from the direct route via the region around airport 1. Note that the plane would not necessarily have to go to airport 1 itself.</p>
 
					<center> <img src="https://www.urionlinejudge.com.br/gallery/images/contests/UOJ_152_J.png" alt="globe" width="500"></center>

					<p>Things are further complicated by the fact that planes have limited fuel supply, and to go longer distances they may need to make a stopover at intermediate airports. Thus, depending on the fuel capacity, a plane going from airport 2 to airport 3 in the figure might have to stop over at airport 1 (or the fuel capacity might be too low even to go to airport 1, in which case the trip would be impossible to make).</p>

					<p>We make the following simplifying assumptions:</p>

					<ol>
						<li>The surface of the earth is a sphere of radius 6370 km.</li>
						<li>Both time and fuel consumption are directly proportional to distance traveled. In other words we are interested only in total distance traveled.</li>
						<li>The difference in distance caused by planes flying at different altitudes is negligible. Thus, effectively, we assume them to be flying along the earth’s surface.</li>
						<li>A plane may stop for refueling at as many intermediate airports as needed, each time getting a full tank.</li>
					</ol>
				</div>

				<h2>Entrada</h2>

				<div class="input">
					<p>The first line of each test case contains two integers <strong>N</strong> and <strong>R</strong>, where 2 ≤ <strong>N</strong> ≤ 25 is the number of airports and 1 ≤ <strong>R</strong> ≤ 10 000 is the maximum allowed flight distance (in km) from the nearest airport. Each of the next <strong>N</strong> lines contains two integers φ, θ satisfying 0 ≤ φ &lt; 360 and −90 ≤ θ ≤ 90, the longitude and latitude (respectively) of an airport, in degrees. The airports are numbered according to their order in the input starting from one. No two airports are at the same position.</p>

					<p>Following this is a line containing an integer <strong>Q</strong>, satisfying 1 ≤ <strong>Q</strong> ≤ 100. Each of the next <strong>Q</strong> lines contains three integers <strong>s</strong>, <strong>t</strong>, <strong>c</strong> satisfying 1 ≤ <strong>s</strong>, <strong>t</strong> ≤ <strong>N</strong>, <strong>s</strong> != <strong>t</strong>, and 1 ≤ <strong>c</strong> ≤ 50 000, indicating a plane going from airport <strong>s</strong> to airport <strong>t</strong> with a fuel capacity yielding a range of <strong>c</strong> km.</p>
				</div>

				<h2>Saída</h2>

				<div class="output">
					<p>For each test case, display the case number followed by one line for each query containing the length in km of the shortest flight path between airport <strong>s</strong> and <strong>t</strong>, subject to the fuel constraint <strong>c</strong>. Display the length accurate to three decimal places. If there is no permissible path between the two airports, then display the word impossible instead.</p>

					<p>You may assume the answer is numerically stable for perturbations of up to 0.1 km of <strong>R</strong> or <strong>c</strong>.</p>
				</div>

				<div class="both"></div>

				<table>
					<thead>
						<tr>
							<td>Exemplo de Entrada</td>
							<td>Exemplo de Saída</td>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td class="division">
								<p>3 2000</p>

								<p>0 0</p>

								<p>0 30</p>

								<p>30 0</p>

								<p>3</p>

								<p>2 3 5000</p>

								<p>2 3 4000</p>

								<p>2 3 3000</p>

								<p>2 10000</p>

								<p>45 45</p>

								<p>225 -45</p>

								<p>2</p>

								<p>1 2 50000</p>

								<p>2 1 50000</p>

							</td>
							<td>
								<p>Case 1:</p>

								<p>4724.686</p>

								<p>6670.648</p>

								<p>impossible</p>

								<p>Case 2:</p>

								<p>impossible</p>

								<p>impossible</p>

							</td>
						</tr>
					</tbody>
				</table>

				<div class="both"></div>
	
				<p class="footer">
					ICPC 2012 World Finals
				</p>
			</div>

		</body>
	</html>