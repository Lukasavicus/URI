<!DOCTYPE html>
    <html>
        <head>
            <title>URI 1509 - Contando Ambiguidades</title>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <meta name="author" content="URI Online Judge; www.urionlinejudge.edu.br" />
            <meta name="description" content="URI Online Judge - Problema 1509 - Contando Ambiguidades" />

            <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,700" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="https://urionlinejudge.r.worldssl.net/repository/default.css" />

	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-28047757-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-28047757-1');
	</script>
        </head>
        <body>

            <div class="header">
                <span>URI Online Judge | 1509</span>
                <h1>Contando Ambiguidades</h1>
                <div>
                    <p>Por Gabriel Poesia, UFMG <img src='https://urionlinejudge.r.worldssl.net/gallery/images/flags/br.gif' alt='BR' /> Brazil</p>
                </div>
                <strong>Timelimit: 6</strong>
            </div>

            <div class="problem">

                <div class="description">
                    <p>Enquanto vinham para a Escola de Verão de ônibus, um competidor atento notou uma placa que continha uma propaganda com a seguinte URL:<em>www.programs.healthyfood.ma</em>(ele suspeita que o .ma seja para "Marte", mas isto é improvável). Por estarem discutindo as novas features de C++11, o competidor e um amigo pensaram que o "programs" na URL fosse relacionado ao resultado da programação de computadores: programas. Porém, acontece que a URL foi infeliz: era, na verdade, a junção de duas palavras: o adjetivo "pro", que em inglês significa "em favor de", e o substantivo "grams", um tipo de legumes usados em pratos de comida. Isto explica o fato de a URL ter levado os dois amigos a uma página Web contendo fotos de mulheres saudáveis, ao invés de tutoriais sobre <em>variadic templates</em>!</p>

<p>Depois de rirem do acontecido, os dois amigos estão curiosos sobre essas ambiguidades em URLs. Eles começaram a olhar para todas as placas na estrada e a escrever as URLs que elas contém. Porém, eles rapidamente obtiveram muitas URLs para verificar - muito mais que um programador aceita fazer "na mão". Por isto, eles querem escrever um programa que, data a lista de palavras que eles conhecem, conta de quantas formas distintas uma certa palavra pode ser obtida pela concatenação de uma ou mais palavras da lista.</p>

<p>Ambos são programadores muito habilidosos e já projetaram o algoritmo perfeito para este problema. O principal problema é que os laptops deles estão sem bateria, e eles não querem programar em seus smartphones (não há acesso à Internet nas estradas para acessar um computador com um compilador remotamente). Porque você está sentado próximo a eles, e seu laptop tem bateria para mais de 10 minutos (suficiente, não?) de programação, eles pediram para que você escrevesse tal programa para eles. É claro que eles não contaram a você o algoritmo que projetaram, porque confiam nas suas próprias habilidades de resolução de problemas. Você pode escrever o programa para eles?</p>

<p>Note que um palavra pode ser usada várias vezes no processo de concatenação. Por exemplo, se os amigos conhecem as palavras "a" e "aa", eles podem formar a palavra "aaa" dos seguintes 3 jeitos (aqui, + significa concatenação).</p>

<ul>
	<li>"a" + "a" + "a"</li>
	<li>"a" + "aa"</li>
	<li>"aa" + "a"</li>
</ul>

<p>Assim, a resposta para este caso seria 3.</p>

<p>Da mesma forma, há duas maneiras de se obter a palavra "aa":</p>

<ul>
	<li>"a" + "a"</li>
	<li>"aa"</li>
</ul>

<p>Note que uma palavra pode ser usada sozinha, se os amigos a conhecem.</p>

                </div>

                <h2>Entrada</h2>

                <div class="input">
                    <p>A entrada contém vários casos de teste. Cada caso de teste começa com uma linha contendo um inteiro positivo <strong>D</strong> (no máximo 10<sup>5</sup>), o número de palavras que os amigos conhecem. As próximas <strong>D</strong> linhas contém essas palavras. Cada linha contém uma palavra distinta. Depois, há uma linha contendo um inteiro positivo <strong>U</strong> (no máximo 1000), que é o número de palavras que os competidores escreveram. Após esta linha, há <strong>U</strong> linhas, cada uma contendo uma dessas palavras.</p>

<p>Toda palavra no arquivo de entrada é composta por no máximo 100 caracteres alfabéticos.</p>

                </div>

                <h2>Saída</h2>

                <div class="output">
                    <p>Para cada caso de teste imprima <strong>U</strong> linhas. A i-ésima linha no arquivo de saída deve conter o número de maneiras distintas de se obter a i-ésima palavra que os dois competidores escreveram pela concatenação de palavras que eles conhecem. Este número pode ser muito grande. Por isto, imprima o resto da divisão da resposta por 10<sup>9</sup>+ 7.</p>

                </div>

                <div class="both"></div>

                <table>
                    <thead>
                        <tr>
                            <td>Exemplo de Entrada</td>
                            <td>Exemplo de Saída</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="division">
                                <p>3<br />
programs<br />
pro<br />
grams<br />
1<br />
programs</p>

                            </td>
                            <td>
                                <p>2</p>

                            </td>
                        </tr>
                    </tbody>
                </table>
                
                <p class="footer">
                    Contest Maratona Verão 2014
                </p>
            </div>

        </body>
    </html>