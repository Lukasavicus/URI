<!DOCTYPE html>
    <html>
        <head>
            <title>URI 1674 - Fractran</title>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <meta name="author" content="URI Online Judge; www.urionlinejudge.edu.br" />
            <meta name="description" content="URI Online Judge - Problema 1674 - Fractran" />

            <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,700" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="https://urionlinejudge.r.worldssl.net/repository/default.css" />

	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-28047757-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-28047757-1');
	</script>
        </head>
        <body>

            <div class="header">
                <span>URI Online Judge | 1674</span>
                <h1>Fractran</h1>
                <div>
                    <p>Contest Local, Universidade de Ulm <img src='https://urionlinejudge.r.worldssl.net/gallery/images/flags/de.gif' alt='DE' /> Alemanha</p>
                </div>
                <strong>Timelimit: 3</strong>
            </div>

            <div class="problem">

                <div class="description">
                    <p>Para jogar o "jogo da fração", correspondente a uma lista dada <em>f<sub>1</sub>, f<sub>2</sub>, ..., f<sub>k</sub></em> de frações e inteiros começando em N, você repetidamente multiplica o inteiro que você tem em qualquer fase (inicialmente N) pelos primeiros f<sub>i</sub> na lista para os quais a resposta é um inteiro. Sempre que não exista tal f<sub>i</sub>, o jogo para.</p>

                    <p>Formalmente, definimos uma sequência <em>S<sub>0</sub>=N</em>, e <em>S<sub>j+1</sub>=f<sub>i</sub>S<sub>j</sub></em>, se para 1 ≤ I ≤ k, o número <em>fiS<sub>j</sub></em> é um inteiro, mas os números <em>f<sub>1</sub>S<sub>j</sub>, ..., f<sub>i-1</sub>S<sub>J</sub></em> não são.</p>

                    <p>Por exemplo, se temos a lista com oito frações f<sub>1</sub>=170/39, f<sub>2</sub>=19/13, f<sub>3</sub>=13/17, f<sub>4</sub>=69/95, f<sub>5</sub>=19/23, f<sub>6</sub>=1/19, f<sub>7</sub>=13/7, f<sub>8</sub>=1/3, e iniciando com N = 21, nós produzimos a sequência (finita) (21,39,170,130,190,138,114,6,2). Em geral, a sequência pode ser infinita.</p>

                    <p>Dada uma lista de frações e um inteiro de início, calcule uma parte da sequência definida. Na verdade, estamos interessados apenas nas potências de 2 que aparecem na sequência.</p>

                </div>

                <h2>Entrada</h2>

                <div class="input">
                    <p>A entrada contém vários casos de teste. Cada caso de teste começa com três inteiros <strong>m, N, k</strong>. Você pode assumir que 1 ≤ <strong>m</strong> ≤ 40, 1 ≤ <strong>N</strong> ≤ 1000, e 1 ≤ <strong>k</strong> ≤ 100. Então seguem <strong>k</strong> frações<strong> f<sub>1</sub>, ..., f<sub>k</sub></strong>. Para cada fração, primeiro seu numerador é dado, seguido por seu denominador. Você pode assumir que ambos são números inteiros positivos menores ou iguais a 1000 e seu maior divisor comum é 1. O último caso de teste é seguido por um zero.</p>

                </div>

                <h2>Saída</h2>

                <div class="output">
                    <p>Para cada caso de teste imprima na linha <strong>m</strong> os números <strong>e<sub>1</sub>, ..., e<sub>m</sub></strong>, separados por um caractere de espaço, de tal forma que <strong>2<sup>e</sup>1, ..., 2<sup>e</sup>k</strong> são os primeiros <strong>m</strong> números na sequência definida, que são potências de 2. Você pode assumir que há pelo menos <strong>m</strong> potências de 2 entre os primeiros 7654321 elementos da sequência.</p>

                </div>

                <div class="both"></div>

                <table>
                    <thead>
                        <tr>
                            <td>Exemplo de Entrada</td>
                            <td>Exemplo de Saída</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="division">
                                <p>1 21 8 170 39 19 13 13 17 69 95 19 23 1 19 13 7 1 3<br />
20 2 14 17 91 78 85 19 51 23 38 29 33 77 29 95 23 77 19 1 17 11 13 13 11 15 2 1 7 55 1<br />
0</p>

                            </td>
                            <td>
                                <p>1<br />
1 2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67</p>

                            </td>
                        </tr>
                    </tbody>
                </table>
                
                <p class="footer">
                    Univeristy of Ulm Local Contest 2004/2005
                </p>
            </div>

        </body>
    </html>