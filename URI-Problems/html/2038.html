<!DOCTYPE html>
    <html>
        <head>
            <title>URI 2038 - Gerando DNA Alienígena</title>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <meta name="author" content="URI Online Judge; www.urionlinejudge.edu.br" />
            <meta name="description" content="URI Online Judge - Problema 2038 - Gerando DNA Alienígena" />

            <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,700" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="https://urionlinejudge.r.worldssl.net/repository/default.css" />

	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-28047757-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-28047757-1');
	</script>
        </head>
        <body>

            <div class="header">
                <span>URI Online Judge | 2038</span>
                <h1>Gerando DNA Alienígena</h1>
                <div>
                    <p>Por Nicolas A. Alvarez, Universidad Nacional de La Plata  <img src='https://urionlinejudge.r.worldssl.net/gallery/images/flags/ar.gif' alt='AR' /> Argentina</p>
                </div>
                <strong>Timelimit: 1</strong>
            </div>

            <div class="problem">

                <div class="description">
                    <p>GigaFarma é uma das maiores empresas farmacêuticas do mundo, e está atualmente conduzindo experimentos usando DNA alienígena. Seu objetivo é produzir uma cadeia de DNA alienígena que irá resultar no maior lucro possível quando comercializado.</p>

                    <p>Uma cadeia de DNA estranho pode ser entendida como uma sequência não vazia de genes ligados, e por sua vez, cada gene é uma sequência não vazia de bases. Devido ao fato que nem todas as sequências possíveis de bases corresponde a um gene válido, a GigaFarma criou um catálogo de genes que aparecem no DNA alienígena, que são as únicas consideradas sequências válidas de bases. Cada um destes genes tem um valor de acordo com a sua funcionalidade, e uma dada cadeia de DNA alienígena tem um valor de mercado que é a soma dos valores dos genes que o compõem.</p>

                    <p>Vamos representar as diferentes bases com letras minúsculas, 'a' - 'z', e as ligações usando um hífen "-". No exemplo a seguir, podemos ver na esquerda uma possível lista de genes e seus valores correspondentes; à direita há algumas cadeias de DNA alienígena que podem ser formados com esses genes, juntamente com os seus correspondentes valores de mercado.</p>

                    <p class="center"><img alt="" src="https://urionlinejudge.r.worldssl.net/gallery/images/problems/UOJ_2038_01.png" style="width:350px; height:86px"></p>

                    <p>GigaFarma só pode produzir cadeias de DNA muito específicas, que chamamos de produzível. Estas cadeias são uma sequência não vazia de partes de DNA que a empresa pode sintetizar, unidas sem quaisquer ligações adicionais entre eles. Cada parte é uma sequência de bases e conexões que contenham pelo menos uma conexão, mas sem quaisquer ligações consecutivas, iniciais ou finais. Cada parte tem um custo, determinado pela dificuldade associada com a sua produção, de modo que cada cadeia produzível de DNA tem um custo de produção que é a soma dos custos de cada uma das partes que o compõem. No exemplo a seguir, podemos ver na esquerda uma lista de partes de DNA e os seus custos; do lado direito, temos algumas cadeias produzíveis de DNA que podem ser formadas com essas partes, juntamente com os seus custos de produção.</p>

                    <p class="center"><img alt="" src="https://urionlinejudge.r.worldssl.net/gallery/images/problems/UOJ_2038_02.png" style="width:431px; height:107px"></p>

                    <p>Note que pode haver várias maneiras de formar uma mesma cadeia produzível usando diferentes partes. Este é o caso de "como-como-les" no exemplo, que pode ser obtido usando porções "como-co" e "mo-les" com um custo de produção de 7, ou simplesmente usando "como-como-les" com um custo de produção de 12. É claro que, quando existe mais de uma maneira de sintetizar uma determinada cadeia produzível de DNA, GigaFarma sempre faz usando o processo mais barato possível.</p>

                    <p>Claramente, o conjunto de cadeias de DNA alienígena é infinito, assim como o conjunto de cadeias de DNA produzíveis. No entanto, a GigaFarma não está interessada em nenhum destes conjuntos, mas na sua intersecção. Se verificar os exemplos anteriores, podemos ver que "como-les" é uma cadeia de DNA alienígena válida, mas não é produzível, "mo-les" é produzível, mas não é uma cadeia de DNA alienígena, e "como-como-les" é produzível e uma cadeia de DNA alienígena.</p>

                    <p>Para cada cadeia de DNA alienígena e produzível, a empresa pode comercializar essa cadeia para obter um lucro que equivale ao valor dessa cadeia menos o seu custo de produção do mercado. É claro que, se este lucro não é positivo, a cadeia correspondente nunca será produzida. Por existir muito material genético em todo o lugar, GigaFarma pagaria qualquer coisa para saber o lucro máximo que ela pode obter por algumas cadeias de DNA produzível e alienígena.</p>

                </div>

                <h2>Entrada</h2>

                <div class="input">
                    <p>Cada caso de teste é descrito usando várias linhas. A primeira linha contém dois números inteiros G e P, representando o número de genes no catálogo e o número de partes que a GigaFarma pode produzir (1 ≤ L, P ≤ 100).</p>

                    <p>Cada uma das seguintes G linhas descrevem um gene diferente, usando uma string S e um número inteiro V. A string S tem entre 1 e 10 caracteres, e é formada exclusivamente por letras minúsculas representando as bases que formam este gene; o número inteiro V representa o valor desse gene (1 ≤ V ≤ 1000).</p>

                    <p>Cada uma das P linhas seguintes descrevem uma parte diferente do DNA, usando uma string T e um inteiro C. A string T tem entre 1 e 30 caracteres, e é composta de apenas letras minúsculas e hifens, respectivamente representando as bases e as conexões nesta parte. T contém pelo menos uma conexão, mas nunca terá conexões iniciais, finais ou consecutivos. O inteiro C representa o custo de produção para a parte correspondente (1 ≤ C ≤ 1000).</p>

                    <p>Note que em todos os casos de teste, todos os genes são diferentes um dos outros, e todas as partes também são diferentes uma da outra. O fim da entrada é indicado por uma linha que contém duas vezes o número -1.</p>

                </div>

                <h2>Saída</h2>

                <div class="output">
                    <p>Para cada caso de teste, você deve imprimir uma única linha contendo um número inteiro, representando o lucro máximo que a GigaFarma pode obter a partir de uma cadeia de DNA produzível e alienígena. Se nenhum lucro é positivo, você deve imprimir o valor 0. Se o lucro pode ser arbitrariamente grande, você deve imprimir um asterisco '*'.</p>

                </div>

                <div class="both"></div>

                <table>
                    <thead>
                        <tr>
                            <td>Exemplo de Entrada</td>
                            <td>Exemplo de Saída</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="division">
                                <p>4 6</p>

<p>hola 5</p>

<p>como 5</p>

<p>les 3</p>

<p>va 2</p>

<p>como-co 3</p>

<p>mo-co 8</p>

<p>mo-les 4</p>

<p>como-como-les 12</p>

<p>ta-no-sirven 100</p>

<p>hasta-es 200</p>

<p>2 3</p>

<p>xyz 1000</p>

<p>zyxxyz 1000</p>

<p>xyz-zyx 1</p>

<p>zyx-xyz 1</p>

<p>xyz-xyz-zyx-xyz 1</p>

<p>2 1</p>

<p>abc 1</p>

<p>abcabc 1000</p>

<p>abc-abc 999</p>

<p>1 1</p>

<p>ser 10</p>

<p>no-ser 5</p>

<p>-1 -1</p>

                            </td>
                            <td>
                                <p>6</p>

<p>0</p>

<p>*</p>

<p>0</p>

                            </td>
                        </tr>
                    </tbody>
                </table>

                <div class="both"></div>              
            <p class="footer">
                    Torneo Argentino de Programación — ACM–ICPC 2012
                </p>
            </div>

        </body>
    </html>