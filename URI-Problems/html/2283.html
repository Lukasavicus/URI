
	<!DOCTYPE html>
	<html>
		<head>
			<title>URI 2283 - Keyboarding</title>
			<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
			<meta name="author" content="URI Online Judge; www.urionlinejudge.edu.br" />
			<meta name="description" content="URI Online Judge - Problem F - Keyboarding" />

			<link href="https://fonts.googleapis.com/css?family=Ubuntu:400,700" rel="stylesheet" type="text/css">
			<link rel="stylesheet" type="text/css" href="https://urionlinejudge.r.worldssl.net/repository/contest.css" />

	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-28047757-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-28047757-1');
	</script>
		</head>
		<body>

			<div class="header">
				<span>URI Online Judge | 2283</span>
				<h1>Keyboarding</h1>
				<div>
					<p>By ICPC 2015 World Finals <img src='https://urionlinejudge.r.worldssl.net/gallery/images/flags/ma.gif' alt='MA' /> Morocco</p>
				</div>
				<strong>Timelimit: 4</strong>
			</div>

			<div class="problem">

				<div class="description">
					<p>How many keystrokes are necessary to type a text message? You may think that it is equal to the number of characters in the text, but this is correct only if one keystroke generates one character. With pocketsize devices, the possibilities for typing text are often limited. Some devices provide only a few buttons, significantly fewer than the number of letters in the alphabet. For such devices, several strokes may be needed to type a single character. One mechanism to deal with these limitations is a virtual keyboard displayed on a screen, with a cursor that can be moved from key to key to select characters. Four arrow buttons control the movement of the cursor, and when the cursor is positioned over an appropriate key, pressing the fifth button selects the corresponding character and appends it to the end of the text. To terminate the text, the user must navigate to and select the Enter key. This provides users with an arbitrary set of characters and enables them to type text of any length with only five hardware buttons.</p>

					<p>In this problem, you are given a virtual keyboard layout and your task is to determine the minimal number of strokes needed to type a given text, where pressing any of the five hardware buttons constitutes a stroke. The keys are arranged in a rectangular grid, such that each virtual key occupies one or more connected unit squares of the grid. The cursor starts in the upper left corner of the keyboard and moves in the four cardinal directions, in such a way that it always skips to the next unit square in that direction that belongs to a different key. If there is no such unit square, the cursor does not move.</p>

					<center><img src="https://www.urionlinejudge.com.br/gallery/images/contests/UOJ_155_F.png"  width="500" alt="" /></center>

					<p style="text-align:center">Figure F.1: Sample Input 1. An example virtual keyboard and hardware buttons.</p>

					<p>Figure F.1, illustrating Sample Input 1, shows a possible way to type CONTEST using 30 strokes on an example virtual keyboard. The red dots represent the virtual keys where the select button was pressed.</p>
				</div>

				<h2>Input</h2>

				<div class="input">
					<p>The first line of the input contains two integers <strong>r</strong> and <strong>c</strong> (1 ≤ <strong>r</strong>, <strong>c</strong> ≤ 50), giving the number of rows and columns of the virtual keyboard grid. The virtual keyboard is specified in the next <strong>r</strong> lines, each of which contains <strong>c</strong> characters. The possible values of these characters are uppercase letters, digits, a dash, and an asterisk (representing Enter). There is only one key corresponding to any given character. Each key is made up of one or more grid squares, which will always form a connected region. The last line of the input contains the text to be typed. This text is a non-empty string of at most 10 000 of the available characters other than the asterisk.</p>
				</div>

				<h2>Output</h2>

				<div class="output">
					<p>Display the minimal number of strokes necessary to type the whole text, including the Enter key at the end. It is guaranteed that the text can be typed.</p>
				</div>

				<div class="both"></div>

				<table>
					<thead>
						<tr>
							<td>Input Samples</td>
							<td>Output Samples</td>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td class="division">
								<p>4 7</p>

								<p>ABCDEFG</p>

								<p>HIJKLMN</p>

								<p>OPQRSTU</p>

								<p>VWXYZ**</p>

								<p>CONTEST</p>

							</td>
							<td>
								<p>30</p>

							</td>
						</tr>
					</tbody>
				</table>

				<div class="both"></div>
	
		        <table>
		            <thead>
		            </thead>
		            <tbody>
		                <tr>
		                    <td class="division">
		                        <p>5 20</p>

								<p>12233445566778899000</p>

								<p>QQWWEERRTTYYUUIIOOPP</p>

								<p>-AASSDDFFGGHHJJKKLL*</p>

								<p>--ZZXXCCVVBBNNMM--**</p>

								<p>--------------------</p>

								<p>ACM-ICPC-WORLD-FINALS-2015</p>

		                    </td>
		                    <td>
		                        <p>160</p>

		                    </td>
		                </tr>
		            </tbody>
		        </table>

		        <div class="both"></div>

		        <table>
		            <thead>
		            </thead>
		            <tbody>
		                <tr>
		                    <td class="division">
		                        <p>2 19</p>

								<p>ABCDEFGHIJKLMNOPQZY</p>

								<p>X*****************Y</p>

								<p>AZAZ</p>

		                    </td>
		                    <td>
		                        <p>19</p>

		                    </td>
		                </tr>
		            </tbody>
		        </table>

		        <table>
		            <thead>
		            </thead>
		            <tbody>
		                <tr>
		                    <td class="division">
		                        <p>6 4</p>

								<p>AXYB</p>

								<p>BBBB</p>

								<p>-KLMB</p>

								<p>OPQB</p>

								<p>DEFB</p>

								<p>GHI*</p>

								<p>AB</p>

		                    </td>
		                    <td>
		                        <p>7</p>

		                    </td>
		                </tr>
		            </tbody>
		        </table>
				<p class="footer">
					ICPC 2015 World Finals
				</p>
			</div>

		</body>
	</html>