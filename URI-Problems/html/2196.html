
	<!DOCTYPE html>
	<html>
		<head>
			<title>URI 2196 - Coffee Central</title>
			<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
			<meta name="author" content="URI Online Judge; www.urionlinejudge.edu.br" />
			<meta name="description" content="URI Online Judge - Problema 2196 - Coffee Central" />

			<link href="https://fonts.googleapis.com/css?family=Ubuntu:400,700" rel="stylesheet" type="text/css">
			<link rel="stylesheet" type="text/css" href="https://urionlinejudge.r.worldssl.net/repository/contest.css" />

	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-28047757-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-28047757-1');
	</script>
		</head>
		<body>

			<div class="header">
				<span>URI Online Judge | 2196</span>
				<h1>Coffee Central</h1>
				<div>
					<p>Por ICPC 2011 World Finals <img src='https://urionlinejudge.r.worldssl.net/gallery/images/flags/us.gif' alt='US' /> United States</p>
				</div>
				<strong>Timelimit: 5</strong>
			</div>

			<div class="problem">

				<div class="description">
					<p>Is it just a fad or is it here to stay? You’re not sure, but the steadily increasing number of coffee shops that are opening in your hometown has certainly become quite a draw. Apparently, people have become so addicted to coffee that apartments that are close to many coffee shops will actually fetch higher rents.</p>

					<p>This has come to the attention of a local real-estate company. They are interested in identifying the most valuable locations in the city in terms of their proximity to large numbers of coffee shops. They have given you a map of the city, marked with the locations of coffee shops. Assuming that the average person is willing to walk only a fixed number of blocks for their morning coffee, you have to find the location from which one can reach the largest number of coffee shops. As you are probably aware, your hometown is built on a square grid layout, with blocks aligned on north-south and east-west axes. Since you have to walk along streets, the distance between intersections (a, b) and (c, d) is |a − c| + |b − d|.</p>
				</div>

				<h2>Entrada</h2>

				<div class="input">
					<p>The input contains several test cases. Each test case describes a city. The first line of each test case contains four integers <strong>dx</strong>, <strong>dy</strong>, <strong>n</strong>, and <strong>q</strong>. These are the dimensions of the city grid <strong>dx</strong> × <strong>dy</strong> (1 ≤ <strong>dx</strong>, <strong>dy</strong> ≤ 1000), the number of coffee shops <strong>n</strong> (0 ≤ <strong>n</strong> ≤ 5 · 10<sup>5</sup> ), and the number of queries <strong>q</strong> (1 ≤ <strong>q</strong> ≤ 20). Each of the next <strong>n</strong> lines contains two integers <strong>x<sub>i</sub></strong> and <strong>y<sub>i</sub></strong> (1 ≤ <strong>x<sub>i</sub></strong> ≤ <strong>dx</strong>, 1 ≤ <strong>y<sub>i</sub></strong> ≤ <strong>dy</strong>); these specify the location of the <strong>i</strong><sup>th</sup> coffee shop. There will be at most one coffee shop per intersection. Each of the next <strong>q</strong> lines contains a single integer <strong>m</strong> (0 ≤ <strong>m</strong> ≤ 10<sup>6</sup> ), the maximal distance that a person is willing to walk for a cup of coffee.</p>

					<p>The last test case is followed by a line containing four zeros.</p>
				</div>

				<h2>Saída</h2>

				<div class="output">
					<p>For each test case in the input, display its case number. Then display one line per query in the test case. Each line displays the maximum number of coffee shops reachable for the given query distance m followed by the optimal location. For example, the sample output shows that 3 coffee shops are within query distance 1 of the optimal location (3, 4), 4 shops are within query distance 2 of optimal location (2, 2), and 5 shops are within query distance 4 of optimal location (3, 1). If there are multiple optimal locations, pick the location that is furthest south (minimal positive integer y-coordinate). If there is still a tie, pick the location furthest west (minimal positive integer x-coordinate).</p>

					<p>Follow the format of the sample output.</p>
				</div>

				<div class="both"></div>

				<table>
					<thead>
						<tr>
							<td>Exemplo de Entrada</td>
							<td>Exemplo de Saída</td>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td class="division">
								<p>4 4 5 3</p>

								<p>1 1</p>

								<p>1 2</p>

								<p>3 3</p>

								<p>4 4</p>

								<p>2 4</p>

								<p>1</p>

								<p>2</p>

								<p>4</p>

								<p>0 0 0 0</p>

							</td>
							<td>
								<p>Case 1:</p>

								<p>3 (3,4)</p>

								<p>4 (2,2)</p>

								<p>5 (3,1)</p>

							</td>
						</tr>
					</tbody>
				</table>

				<div class="both"></div>

				<p class="footer">
					ICPC 2011 World Finals
				</p>
			</div>

		</body>
	</html>
