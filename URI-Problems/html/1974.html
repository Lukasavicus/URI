
	<!DOCTYPE html>
	<html>
		<head>
			<title>URI 1974 - Além da Escuridão</title>
			<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
			<meta name="author" content="URI Online Judge; www.urionlinejudge.edu.br" />
			<meta name="description" content="URI Online Judge - Problema 1974 - Além da Escuridão" />

			<link href="https://fonts.googleapis.com/css?family=Ubuntu:400,700" rel="stylesheet" type="text/css">
			<link rel="stylesheet" type="text/css" href="https://urionlinejudge.r.worldssl.net/repository/contest.css" />

	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-28047757-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-28047757-1');
	</script>
		</head>
		<body>

			<div class="header">
				<span>URI Online Judge | 1974</span>
				<h1>Além da Escuridão</h1>
				<div>
					<p>Por Leandro Zatesko, UFFS <img src='https://urionlinejudge.r.worldssl.net/gallery/images/flags/br.gif' alt='BR' /> Brazil</p>
				</div>
				<strong>Timelimit: 6</strong>
			</div>

			<div class="problem">

				<div class="description">
                  <p>E esta foi a 3<sup>ạ</sup> Maratona de Programação <em>Júnior</em> da UFFS! Esperamos sinceramente que você tenha se divertido! Se porventura você não conseguiu resolver algum problema, discuta-o depois com seus colegas e professores, estude os conteúdos que você ainda não domina, e encare o problema novamente. Todos os problemas desta competição estarão disponíveis no URI Online Judge assim que possível. Se você nunca havia participado de uma Maratona de Programação antes e gostou, venha participar do Clube de Programação para se aperfeiçoar, aprender mais e treinar!</p>

                   <p class="center"><img alt="" src="https://urionlinejudge.r.worldssl.net/gallery/images/contests/l1.jpg" style=""> <img alt="" src="https://urionlinejudge.r.worldssl.net/gallery/images/contests/l2.jpg" style=""> <img alt="" src="https://urionlinejudge.r.worldssl.net/gallery/images/contests/l3.jpg" style=""></p>

					<p>Mas antes de dizermos adeus, temos ainda mais uma tarefa para você. O oeste catarinense está na escuridão total, pois um tornado devastou a região. Antes, a infraestrutura elétrica da região era maravilhosa, de modo que duas torres de energia eram conectadas diretamente por cabos de energia se e somente se entre essas torres existia uma estrada. O tornado não danificou as estradas, apenas as torres e cabos de energia. De todas as empresas que se propuseram a restaurar a infraestrutura elétrica da região, a que apresentou a melhor proposta foi a Pikachu S. A. Para começar os trabalhos, a Pikachu S. A. exigiu do Governo algumas informações. Se essas informações não satisfizerem algumas condições, a Pikachu S. A. rescindirá o contrato e o Governo terá de contratar uma empresa, para nossa tristeza. A saber, as condições exigidas pela Pikachu S. A. são:</p>

<ol>
	<li>A empresa não construirá nenhuma torre nova, apenas restaurará todas as torres antigas.</li>
	<li>A empresa não conectará duas torres por cabos de energia se essas torres não eram antes conectadas.</li>
	<li>A empresa fará apenas o mínimo de conexões entre torres necessário para que as torres estejam todas interconectadas, direta ou indiretamente, e gastará o mínimo possível de metros de cabeamento.</li>
	<li>Cada torre que for restaurada precisará receber um funcionário da Pikachu S. A. para monitorar a torre diariamente. Este funcionário pode ser um funcionário efetivo ou um estagiário.</li>
	<li>Se os funcionários que duas torres receberem forem estagiários, então deve existir uma estrada conectando as duas torres diretamente.</li>
	<li>Se os funcionários que duas torres receberem forem efetivos, então não deve existir uma estrada conectando as duas torres diretamente.</li>
	<li>O número de funcionários efetivos deve ser o menor possível.</li>
</ol>

<p>Uma curiosidade acerca da infraestrutura antiga é que a cada torre havia sido atribuído um código binário, de modo que a conexão entre duas torres, se existisse, custasse, em metros de cabeamento, exatamente o comprimento do maior subcódigo binário comum aos códigos de ambas as torres. Por exemplo, se os códigos de duas torres eram respectivamente 000011 e 001100, o custo da conexão entre essas duas torres era, e continua sendo, 4.</p>
				</div>

				<h2>Entrada</h2>

				<div class="input">
					<p>A primeira linha da entrada contém dois inteiros, <strong>N</strong> e <strong>M</strong> (2 ≤ <strong>N</strong> ≤ 10<sup>3</sup>, 0 ≤ <strong>M</strong> ≤ 10<sup>5</sup>), os quais representam respectivamente o número de torres e o número de conexões na infraestrutura antiga, sendo cada conexão descrita numa das <strong>M</strong> linhas seguintes por dois inteiros, <strong>i</strong> e <strong>j</strong> (1 ≤ <strong>i</strong>, <strong>j</strong> ≤ <strong>N</strong>), os quais identificam as torres que eram conectadas. Por fim, a <strong>i</strong>-ésima das <strong>N</strong> últimas linhas da entrada descreve o código binário, de comprimento positivo não maior que 100, da torre <strong>i</strong>.</p>
				</div>

				<h2>Saída</h2>

				<div class="output">
					<p>Se não é possível satisfazer as condições da Pikachu S. A., imprima uma linha contendo unicamente a carinha <strong>:[</strong>. Senão, imprima duas linhas: a primeira contendo unicamente a carinha <strong>:]</strong>; e a segunda contendo três valores, representando respectivamente o número de estagiários necessários, o número de funcionários efetivos e o custo mínimo necessário para restaurar a infraestrutura.</p>
				</div>

				<div class="both"></div>

				<table>
					<thead>
						<tr>
							<td>Exemplo de Entrada</td>
							<td>Exemplo de Saída</td>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td class="division">
								<p>6 11<br />
1 2<br />
1 3<br />
1 4<br />
1 5<br />
1 6<br />
2 3<br />
2 6<br />
3 4<br />
3 6<br />
4 6<br />
5 6<br />
000011<br />
001100<br />
001111<br />
110000<br />
110011<br />
111100</p>

							</td>
							<td>
								<p>:]<br />
4 2 16</p>

							</td>
						</tr>
					</tbody>
				</table>

				<div class="both"></div>
	
				<p class="footer">
					3<sup>ạ</sup> Maratona de Programação <em>Júnior</em> da UFFS
				</p>
			</div>

		</body>
	</html>
