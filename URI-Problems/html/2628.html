
<!DOCTYPE html>
<html>
	<head>
		<title>URI 2628 - Caça ao Tesouro</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="author" content="URI Online Judge; www.urionlinejudge.edu.br" />
		<meta name="description" content="URI Online Judge - Problema 2628 - Caça ao Tesouro" />

		<link href="https://fonts.googleapis.com/css?family=Ubuntu:400,700" rel="stylesheet" type="text/css">
		<link rel="stylesheet" type="text/css" href="https://urionlinejudge.r.worldssl.net/repository/contest.css" />

	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-28047757-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-28047757-1');
	</script>
	</head>
	<body>

		<div class="header">
			<span>URI Online Judge | 2628</span>
			<h1>Caça ao Tesouro</h1>
			<div>
				<p>Por Guilherme de Lima Bernardes, UNB <img src='https://urionlinejudge.r.worldssl.net/gallery/images/flags/br.gif' alt='BR' /> Brazil</p>
			</div>
			<strong>Timelimit: 1</strong>
		</div>

		<div class="problem">

			<div class="description">
				<p>
					O arquipélago da Nlogônia é formado por ilhas inabitadas e mal assombradas. Cada ilha possui um pequeno cais e <strong>N</strong> cavernas que são acessadas exclusivamente por <strong>M</strong> trilhas secretas. Em tempos passados, elas eram usadas por piratas para abrigar joias, bebidas e mercadorias obtidas após saques em cidades e navios. Com o fim dessa era, acredita-se que existam tesouros perdidos em algumas ilhas.
				</p>
				<p>
					Por questões de segurança, os piratas tinham um método bem curioso para guardar seus pertences. Para esconder um tesouro, escolhia-se uma única ilha. Em primeiro lugar, calculava-se a área de cada caverna. Por acreditarem que números primos traziam sorte, selecionava-se apenas cavernas cujo valor da área também fosse um número primo, totalizando <strong>K</strong> cavernas. Enfim, o tesouro era dividido em <strong>K</strong> partes iguais e distribuído ao longo das cavernas selecionadas.
				</p>
				<p>
					Após vasculhar destro¸cos de um antigo navio pirata, Rafael encontrou mapas descrevendo algumas ilhas onde possivelmente tesouros foram escondidos. Como Rafael reprovou a disciplina de algoritmos, ele pediu sua ajuda para escrever um programa em que dadas as características de uma ilha, determine o menor tempo possível para sair do cais, recolher o tesouro, ou seja, passar por todas as cavernas que contém partes do tesouro e em seguida, retornar ao cais.
				</p>	
			
			</div>

			<h2>Entrada</h2>

			<div class="input">				
				<p>
					A entrada é composta por vários casos de teste. A primeira linha de um caso de teste possui dois inteiros <strong>N</strong> e <strong>M</strong> (1 ≤ <strong>N</strong> ≤ 100, 1 ≤ <strong>M</strong> ≤ <strong>N</strong>(<strong>N</strong> −1)/2), representando, respectivamente, o número de cavernas de um ilha e a quantidade de trilhas secretas. A segunda linha é composta por <strong>N</strong> inteiros, onde o i-ésimo número <strong>X<sub>i</sub></strong> representa a área da i-ésima caverna (1 ≤ <strong>X<sub>i</sub></strong> ≤ 10<sup>5</sup>). Você pode assumir que haverá entre 1 e 15 números primos. Portanto, 1 ≤ <strong>K</strong> ≤ 15. As próximas <strong>M</strong> linhas possuem três inteiros <strong>A</strong>, <strong>B</strong> e <strong>C</strong> (1 ≤ <strong>A</strong>, <strong>B</strong> ≤ <strong>N</strong> + 1, <strong>A</strong> != <strong>B</strong> e 1 ≤ <strong>C</strong> ≤ 1000) indicando que existe uma trilha secreta entre as cavernas <strong>A</strong> e <strong>B</strong> e que são gastos <strong>C</strong> minutos para completar o trajeto. O valor <strong>N</strong> + 1 representa o cais da ilha, portanto, quando <strong>A</strong> ou <strong>B</strong> for igual <strong>N</strong> + 1 significa que existe uma trilha entre o cais e uma das cavernas. Você pode assumir que sempre será possível percorrer um caminho entre qualquer par de cavernas, ou entre o cais e qualquer caverna.
				</p>
			</div>

			<h2>Saída</h2>

			<div class="output">
				<p>
					Para cada caso de teste imprima o valor que representa, em minutos, o menor tempo possível para Rafael sair do cais da ilha, recolher o tesouro e retornar ao cais. Você deve desprezar o tempo gasto por Rafael para pegar parte do tesouro e atravessar uma caverna.
				</p>
			</div>

			<div class="both"></div>

			<table>
				<thead>
					<tr>
						<td>Exemplo de Entrada</td>
						<td>Exemplo de Saída</td>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td class="division">
							<p>3 4</p>
							<p>101 95 991</p>
							<p>1 4 20</p>
							<p>2 3 5</p>
							<p>4 3 20</p>
							<p>1 2 5</p>
							<p>2 2</p>
							<p>1 2</p>
							<p>1 3 15</p>
							<p>2 1 30</p>
						</td>
						<td>
							<p>50</p>
							<p>90</p>
						</td>
					</tr>
				</tbody>
			</table>

		<div class="both"></div>

			<p class="footer">
				Maratona de Programação UnB/CIC 2015.
</p>
		</div>

	</body>
</html>
